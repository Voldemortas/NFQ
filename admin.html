<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Administravimas</title>
    </head>
    <body>
        <button onclick="load().catch(wrong)">Užkrauti duomenis</button>
        <button onclick="remove()">Ištrinti duomenis</button>
        <div id="message"></div>
        <div id="data"></div>
        <script src="scripts/init.js"></script>
        <script>
            function update() {
                document.getElementById('data').innerHTML =
                    data.length == 0
                        ? 'Duomenų nėra'
                        : 'Esami duomenys: ' +
                          data
                              .map(
                                  e =>
                                      (e.id + '').padStart(3, 0) +
                                      ` ${e.time} ${e.subject}`
                              )
                              .join('<br />');
            }
            async function load() {
                let input = await fetch('backend/clients.js');
                data = await input.json();
                localStorage = data;
                document.getElementById('message').innerHTML =
                    'Duomenys sėkmingai užkrauti';
                update();
            }
            function wrong() {
                document.getElementById('message').innerHTML =
                    'Duomenų nepavyko užkrauti';
                update();
            }
            function remove() {
                localStorage.removeItem(name);
                document.getElementById('message').innerHTML =
                    'Duomenys sėkmingai ištrinti';
                update();
            }
            init();
            update();
        </script>
    </body>
</html>
